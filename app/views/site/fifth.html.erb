<h1>People</h1>

<%
=begin
  Subscription to strem
  `teststr` will be encrypted over the attribute signed-stream-name from
  turbo-cable-stream-source HTML tag
=end
%>
<%= turbo_stream_from "teststr" %>

<%
=begin
  you can test if from rails console
  `Turbo::StreamsChannel.broadcast_update_to(
    "teststr",
    target: "broadcast",
    html: "foo"
  )`
  Note: If you want to try out Turbo Streams from the console, use the
  redis adapter in cable.yml. And you also need to have Redis installed and
  running on your machine.
=end
%>
<div id="broadcasts"></div>
<br />

<hr />
Total: <span class="counter"><%= @count %></span>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Age</th>
    </tr>
  </thead>

  <tbody id="people">
    <tr>
      <td>John</td>
      <td>john@mail.com</td>
      <td>25</td>
    </tr>

    <tr>
      <td>Emliy</td>
      <td>emily@mail.com</td>
      <td>43</td>
    </tr>

    <tr>
      <td>Aldo</td>
      <td>aldo@mail.com</td>
      <td>78</td>
    </tr>
  </tbody>
</table>

<%= form_with url: six_page_path, scope: "person" do |f| %>
  <%= hidden_field_tag :count, nil, id: "hidden-counter", value: @count %>

  <%= f.text_field :name, placeholder: "Name" %>
  <%= f.email_field :email, placeholder: "Email" %>
  <%= f.number_field :age, placeholder: "Age", in: 0..150, step: 1 %>

  <%= f.submit :save %>
<% end %>

<hr/>
Total: <span class="counter"><%= @count %></span>
